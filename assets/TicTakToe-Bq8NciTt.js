import{aj as fe,az as me,ak as ce,r as v,j as A,ao as i,n as p,m as l,ar as G,aa as P,aA as ye,as as u,a0 as M,aB as pe,a7 as s,ay as R,aC as H,ap as o,am as B,O as Pe,V as N,v as Ne,at as E,au as U,av as L,aq as _e,aD as J,aw as W,ax as j,an as _,aE as Ve}from"./index-BlX2H3vQ.js";import{V as ke,a as K}from"./VRow-D8JBTIbs.js";const Ce={class:"mb-2"},Se={key:0,class:"mt-6 text-center"},Ae={class:"player-names"},ge={class:"player text-amber-accent-1"},Ie={class:"player text-amber-accent-1"},Te={class:"d-flex justify-center mt-12"},xe={class:"board"},we=["onClick"],be={class:"mt-6 text-center"},De={key:0},Oe={key:1},Ge={key:0},Me={key:1},Re={key:0},Be={key:0,class:"text-subtitle-1"},Ee={key:1,class:"text-subtitle-1"},Ue=fe({__name:"TicTakToe",setup(Le){const n=me(),Q=ce(),Z=["PvP","AI"],r=v("PvP"),f=v(Array(9).fill("")),V=v(!0),d=v(null),x=v([]),k=v(!1),C=v(!1),m=v(""),c=v(""),g=v(!1),I=v(null),ee=A(()=>f.value.some(a=>a!=="")),T=A(()=>n.gameStatus===H.IN_PROGRESS),X=A(()=>V.value?"X":"O"),w=A(()=>n.playerName||""),b=A(()=>r.value==="AI"?"AI":n.secondaryPlayerName||""),ae=A(()=>V.value?w.value:b.value);function z(a){return!d.value&&f.value[a]===""&&T.value}function le(){if(!n.playerName||r.value==="PvP"&&!n.secondaryPlayerName){m.value=n.playerName||"",c.value=n.secondaryPlayerName||"",k.value=!0;return}D()}function te(){if(m.value){if(n.setPlayerName(m.value.trim()),r.value==="PvP"){if(!c.value)return;n.setSecondaryPlayerName(c.value.trim())}else n.setSecondaryPlayerName("AI");k.value=!1,D()}}function ne(){k.value=!1,m.value=n.playerName||"",c.value=r.value==="PvP"&&n.secondaryPlayerName||""}function D(){F(),d.value=null,x.value=[],V.value=!0,C.value=!1,n.startGame(B.TIC)}function F(){f.value=Array(9).fill("")}function $(){F(),d.value=null,x.value=[],V.value=!0,C.value=!1,n.currentGame=null,n.gameStatus=H.NOT_STARTED,typeof n.persist=="function"&&n.persist()}function ue(a){z(a)&&(f.value[a]=X.value,q())}function q(){const a=de(f.value);if(a){x.value=a.line,Y(a.symbol);return}if(f.value.every(e=>e!=="")){Y(null);return}V.value=!V.value,!d.value&&r.value==="AI"&&!V.value&&se()}function se(){const a=f.value.map((t,y)=>t===""?y:-1).filter(t=>t!==-1);if(a.length===0)return;const e=a[Math.floor(Math.random()*a.length)];f.value[e]="O",q()}function oe(){if(g.value=!1,!I.value)return;const a=I.value;I.value=null,$(),r.value=a,h(a)}function re(){g.value=!1,I.value=null}function Y(a){const e=w.value||"Player 1",t=b.value||(r.value==="AI"?"AI":"Player 2");a==="X"?(d.value=e,S(e,_.WIN),S(t,_.LOSS)):a==="O"?(d.value=t,S(t,_.WIN),S(e,_.LOSS)):(d.value="Draw",S(e,_.DRAW),S(t,_.DRAW)),n.finishGame(),C.value=!0}function S(a,e){Q.addEntry({playerName:a,score:e===_.WIN?1:0,gameResult:e,losses:e===_.LOSS?1:0,runs:1,gameType:B.TIC,date:new Date().toISOString()})}function ie(){C.value=!1,D()}function de(a){const e=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[t,y,O]of e)if(a[t]&&a[t]===a[y]&&a[t]===a[O])return{symbol:a[t],line:[t,y,O]};return null}function h(a){if(a==="AI")n.setSecondaryPlayerName("AI"),n.playerName||(m.value="",c.value="",k.value=!0);else if(a==="PvP"){const e=!n.secondaryPlayerName||n.secondaryPlayerName.trim()===""||n.secondaryPlayerName==="AI";(!n.playerName||e)&&(m.value=n.playerName||"",c.value=e?"":n.secondaryPlayerName||"",k.value=!0)}}function ve(a){if(T.value){I.value=a,g.value=!0;return}r.value=a,h(a)}return(a,e)=>(o(),i("div",null,[p("h2",Ce,P(ye(B).TIC),1),l(ke,{class:"mb-4",align:"start","no-gutters":""},{default:u(()=>[l(K,{cols:"12",sm:"6"},{default:u(()=>[l(Pe,{"model-value":r.value,"onUpdate:modelValue":ve,items:Z,label:"Режим",density:"compact"},null,8,["model-value"])]),_:1}),l(K,{cols:"12",sm:"6",class:"d-flex justify-center justify-sm-end"},{default:u(()=>[l(N,{class:"ml-3",variant:"flat",onClick:le,disabled:T.value},{default:u(()=>[...e[6]||(e[6]=[s("Начать",-1)])]),_:1},8,["disabled"]),l(N,{class:"ml-2",variant:"tonal",onClick:$},{default:u(()=>[...e[7]||(e[7]=[s("Сброс",-1)])]),_:1})]),_:1})]),_:1}),T.value?(o(),i("div",Se,[p("div",Ae,[p("span",ge,P(w.value||"Player 1")+" (X)",1),e[8]||(e[8]=p("span",{class:"mx-2"},"против",-1)),p("span",Ie,P(b.value||(r.value==="AI"?"AI":"Player 2"))+" (O)",1)])])):G("",!0),p("div",Te,[p("div",xe,[(o(!0),i(M,null,pe(f.value,(t,y)=>(o(),i("div",{key:y,class:Ne(["cell",{clickable:z(y),win:x.value.includes(y)}]),onClick:O=>ue(y)},P(t),11,we))),128))])]),p("div",be,[!T.value&&!ee.value?(o(),i("div",De,'Нажмите "Начать"')):(o(),i("div",Oe,[d.value?(o(),i("span",Ge,[d.value==="Draw"?(o(),i(M,{key:0},[s("Ничья!")],64)):(o(),i(M,{key:1},[s(P(d.value)+" побеждает!",1)],64))])):(o(),i("span",Me,"Ходит "+P(ae.value)+" ("+P(X.value)+")",1))]))]),l(R,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=t=>k.value=t),"max-width":"420"},{default:u(()=>[l(E,null,{default:u(()=>[l(U,null,{default:u(()=>[e[9]||(e[9]=s("Введите имя",-1)),r.value==="PvP"?(o(),i("span",Re)):G("",!0)]),_:1}),l(L,null,{default:u(()=>[l(J,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),label:"Игрок 1",autofocus:""},null,8,["modelValue"]),r.value==="PvP"?(o(),_e(J,{key:0,modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),label:"Игрок 2"},null,8,["modelValue"])):G("",!0)]),_:1}),l(W,null,{default:u(()=>[l(N,{variant:"outlined",onClick:ne},{default:u(()=>[...e[10]||(e[10]=[s("Отмена",-1)])]),_:1}),l(j),l(N,{variant:"flat",onClick:te,disabled:!m.value||r.value==="PvP"&&!c.value},{default:u(()=>[...e[11]||(e[11]=[s(" Продолжить ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=t=>C.value=t),"max-width":"420"},{default:u(()=>[l(E,null,{default:u(()=>[l(U,null,{default:u(()=>[...e[12]||(e[12]=[s("Игра окончена!",-1)])]),_:1}),l(L,null,{default:u(()=>[d.value==="Draw"?(o(),i("div",Be,"Ничья!")):(o(),i("div",Ee,P(d.value)+" побеждает!",1))]),_:1}),l(W,null,{default:u(()=>[l(j),l(N,{variant:"outlined",onClick:e[3]||(e[3]=t=>C.value=!1)},{default:u(()=>[...e[13]||(e[13]=[s("Закрыть",-1)])]),_:1}),l(N,{variant:"flat",onClick:ie},{default:u(()=>[...e[14]||(e[14]=[s("Играть снова",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=t=>g.value=t),"max-width":"420"},{default:u(()=>[l(E,null,{default:u(()=>[l(U,null,{default:u(()=>[...e[15]||(e[15]=[s("Сменить режим?",-1)])]),_:1}),l(L,null,{default:u(()=>[...e[16]||(e[16]=[s("Игра идет. Изменить режим и сбросить текущую игру?",-1)])]),_:1}),l(W,null,{default:u(()=>[l(N,{variant:"outlined",onClick:re},{default:u(()=>[...e[17]||(e[17]=[s("Нет",-1)])]),_:1}),l(j),l(N,{variant:"flat",onClick:oe},{default:u(()=>[...e[18]||(e[18]=[s("Да",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Xe=Ve(Ue,[["__scopeId","data-v-98e52543"]]);export{Xe as default};
